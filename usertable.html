<html>
<head>
  <title>Soundcloud Map</title>
  <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>

</head>
<body>


<button id='userButton'>Sort by Dallas</button>
<div id='data'></div>

<div class="panel-body">
<div class="form-group">
  <label for="pwd">Nearest Major City:</label>
    <select class="form-control" id="cityInput">
    <option hidden>Choose a city...</option>
    <option value="New York City">New York City</option>
    <option value="Philadelphia">Philadelphia</option>
    <option value="Dallas">Dallas</option>
    <option value="Los Angeles">Los Angeles</option>
    <option value="Boston">Boston</option>
    <option value="Chicago">Chicago</option>           
    </select>
</div>
<button type="submit" class="btn btn-success" id="userSubmit">Submit</button>
</div>

<script>

$('#userSubmit').click(function() {
      var city = $('#cityInput').val();
      var queryUrl = 'https://theproconnect.firebaseio.com/.json?orderBy=%22city%22&equalTo=%22' + city + '%22';
      $.ajax({url: queryUrl, method:'GET'})
      .done(function(response){
        console.log(response);
      });
    });

</script>

<div class="row">
          <div class="panel panel-success">
            <div class="panel-heading">   
            Users
            </div>
            <div class="panel-body">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>City</th>
                    <th>Genre</th>
                    <th>Experience</th>
                    <th>Tag</th>
                    <th>Email</th>
                  </tr>
                </thead>
                <tbody id="userTable">
                </tbody>
              </table>
            </div>
          </div>
        </div>

<div id='div1'></div>
<div id='div2'></div>
<div id='div3'></div>

<script type="text/javascript">

  var city = '';
  var genre = '';
  var experience = '';
  var tag = '';
  var email = '';

  var dataRef = new Firebase ('https://theproconnect.firebaseio.com/');

  $('#userSubmit').on('click', function() {
  city = $('#cityInput').val();
  genre = $('#genreInput').val();
  experience = $('#expInput').val();
  tag = $('#tagInput').val();
  email = $('#emailInput').val();

//Pushes Data to Firebase

  dataRef.push ({
    city: city,
    genre: genre,
    experience: experience,
    tag: tag,
    email: email

  });

// Empties Form After Users Clicks Submit

  $('#cityInput').val('Choose a city...');
  $('#genreInput').val('Choose a genre...');
  $('#expInput').val('Choose your experience level...');
  $('#tagInput').val('');
  $('#emailInput').val('');

return false;

});

  dataRef.on("child_added", function(snapshot){

  var city = snapshot.val().city;
  var genre = snapshot.val().genre;
  var experience = snapshot.val().experience;
  var tag = snapshot.val().tag;
  var email = snapshot.val().email;
  var tableRow = $('<tr>'); 

  var trainInfo = [snapshot.val().city, snapshot.val().genre, snapshot.val().experience, snapshot.val().tag, snapshot.val().email];
  //create a for loop to easily create a new table data with  the HTMl from the inputed value 
    for(var i = 0; i < trainInfo.length;i++){
    // create a new td
    var tableData = $('<td>');
    // add the information from the array to the HTMl of this td
    tableData.html(trainInfo[i]);
    // give it an attribute for save measure 
    tableData.attr('data-id', i);
    // append current td to table row 
    tableRow.append(tableData)
  }
  // append the new row to the last child of the table body
  $('#userTable').append(tableRow);
  // return false to prevent constant returning
  return false;
// Handle the errors
}, function(errorObject){
  console.log("Errors handled: " + errorObject.code)

});



</script>

</body>
</html>